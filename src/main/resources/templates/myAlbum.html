<html>
<head>
  <link rel="stylesheet" href="../css/style.css">
</head>
<body>
<header>时光相册</header>
<section class="flexModal fixedLeft">
  <nav>
    <ul>
      <li><a href="/user/main">我的空间</a></li>
      <li class="active"><a th:href="${'/album/albumList?userId='+session.user.getUserId()}">我的相册</a></li>
      <li><a th:href="${'/video/videoList?userId='+session.user.getUserId()}">我的视频</a></li>
      <li><a th:href="${'/album/albumListOfMember?userId='+session.user.getUserId()}">空间成员</a></li>
      <li><a th:href="${'/user/userInfo?userId='+session.user.getUserId()}">我的信息</a></li>
    </ul>
  </nav>
  <article>

  </article>
</section>
<footer style="font-style: normal;font-weight: normal;font-size: 12px;">本系统由何巧莹个人开发维护</footer>
</body>
<script>
  let imgdata = '';
  //选择文件
  function selectImage(obj){
    let f=$(obj).val();
    if(f == null || f === ''){
      document.getElementById('image').src = "";
      $("#image").show();
      return false;
    }
    if(!/\.(?:png|jpg|bmp|gif|PNG|JPG|BMP|GIF)$/.test(f)){
      alert("类型必须是图片(.png|jpg|bmp|gif|PNG|JPG|BMP|GIF)");
      $(obj).val('');
      return false;
    }
    imgdata = new FormData();
    $.each($(obj)[0].files,function(i,file){
      imgdata.append('file', file);
    });
    if(!file.files || !file.files[0]){
      return;
    }
    //将上传的图片显示到页面
    var reader = new FileReader();
    reader.onload = function(evt){
      $("#image").show();
      document.getElementById('image').src = evt.target.result;
      uploadfile = evt.target.result;
    }
    reader.readAsDataURL(file.files[0]);
  }
  var imageurl = "";
  //点击上传
  function importWeldingMachine() {
    var file = $("#file").val();
    $.ajax({
      type : "post",
      async : false,
      url : "ActualWater/uploadimage.do",
      data : imgdata,
      cache : false,
      contentType : false, //不可缺
      processData : false, //不可缺,设置为true的时候,ajax提交的时候不会序列化 data，而是直接使用data
      dataType : "json", //返回数据形式为json
      success : function(result) {
        result=JSON.parse(result);
        if (result) {
          if (!result.success) {
            imageurl = "";
            $.messager.show({title : 'Error',msg : result.errorMsg});
          } else {
            imageurl = result.imgurl;
            //上传图片后，进行保存入库图片信息操作
          }
        }
      },
      error : function(errorMsg) {
        alert("数据请求失败，请联系系统管理员!");
      }
    });
  }

</script>
</html>